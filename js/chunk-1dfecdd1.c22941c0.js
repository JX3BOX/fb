(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1dfecdd1"],{1344:function(t,e,n){"use strict";e["a"]=function(t){return{all:t=t||new Map,on:function(e,n){var a=t.get(e);a?a.push(n):t.set(e,[n])},off:function(e,n){var a=t.get(e);a&&(n?a.splice(a.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var a=t.get(e);a&&a.slice().map((function(t){t(n)})),(a=t.get("*"))&&a.slice().map((function(t){t(e,n)}))}}}},"1ee7":function(t,e,n){"use strict";n("afb3")},"29c2":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r}));var a=n("41cb");function i(t){var e={type:"fb"};return t&&(e=Object.assign(e,t)),Object(a["a"])().get("/api/cms/posts",{params:e})}function r(t){return Object(a["a"])().get("/api/cms/post/".concat(t))}},"44fd":function(t,e,n){"use strict";n("a15b"),n("2c3e");var a=function(){var t=this,e=t._self._c;return e("li",{staticClass:"m-fb-item u-item"},[e("a",{directives:[{name:"reporter",rawName:"v-reporter",value:{data:{href:t.reporterLink(t.item.ID)},caller:t.caller},expression:"{\n            data: {\n                href: reporterLink(item.ID),\n            },\n            caller,\n        }"}],staticClass:"u-banner",attrs:{href:t._f("postLink")(t.item.ID),target:t.target}},[e("img",{key:t.item.ID,attrs:{src:t.getBanner(t.item)},on:{error:function(e){e.target.src=t.errorImg}}})]),e("h2",{staticClass:"u-post",class:{isSticky:t.item.sticky}},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#555","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"}})]),e("a",{directives:[{name:"reporter",rawName:"v-reporter",value:{data:{href:t.reporterLink(t.item.ID)},caller:t.caller},expression:"{\n                data: {\n                    href: reporterLink(item.ID),\n                },\n                caller,\n            }"}],staticClass:"u-title",style:t._f("showHighlight")(t.item.color),attrs:{href:t._f("postLink")(t.item.ID),target:t.target}},[t._v(t._s(t.item.post_title||"无标题"))]),t.item.mark&&t.item.mark.length?e("span",{staticClass:"u-marks"},t._l(t.item.mark,(function(n){return e("i",{key:n,staticClass:"u-mark"},[t._v(t._s(t._f("showMark")(n)))])})),0):t._e(),t.hasPermission?e("span",{staticClass:"u-push"},[t.showPushDate?e("time",{staticClass:"u-push__time",class:{"is-recent":t.isRecent()}},[t._v(t._s(t.pushDate)+" 已推送")]):t._e(),e("el-button",{staticClass:"u-push__btn",attrs:{size:"mini",type:"warning",icon:"el-icon-s-promotion"},on:{click:t.onPush}},[t._v("推送")])],1):t._e()]),e("div",{staticClass:"u-content u-desc"},[t.item.post_meta&&t.item.post_meta.fb_boss?e("div",{staticClass:"u-metalist u-boss-list"},[e("strong",[t._v("首领")]),e("em",t._l(t.format(t.item,"fb_boss"),(function(n,a){return e("b",{key:a,on:{click:function(e){return t.addTopic(n)}}},[t._v(t._s(n))])})),0)]):t._e(),t.item.post_meta&&t.item.post_meta.fb_level?e("div",{staticClass:"u-metalist u-mode-list c-jx3fb-mode"},[e("strong",[t._v("模式")]),e("em",[t._v(t._s(t.format(t.item,"fb_level").join("、")))])]):t._e()]),e("div",{staticClass:"u-misc"},[e("img",{staticClass:"u-author-avatar",attrs:{src:t._f("showAvatar")(t.item.author_info),alt:t._f("showNickname")(t.item.author_info)}}),e("a",{staticClass:"u-author-name",attrs:{href:t._f("authorLink")(t.item.post_author),target:"_blank"}},[t._v(t._s(t._f("showNickname")(t.item.author_info)))]),e("span",{staticClass:"u-date"},[t._v(" Updated on "),"update"==t.order?e("time",[t._v(t._s(t._f("dateFormat")(t.item.post_modified)))]):e("time",[t._v(t._s(t._f("dateFormat")(t.item.post_date)))])])])])},i=[],r=(n("99af"),n("d81d"),n("14d9"),n("a573"),n("1fb9")),s=n("85e4"),o=n("65c2"),c=n("1647"),u=n("e4f1"),l=n("c9d2"),d=n("5a0c"),p=n.n(d),h=n("d8ad"),f={name:"ListItem",props:["item","order","caller"],components:{},data:function(){return{target:Object(s["b"])()}},computed:{client:function(){var t;return null===(t=this.item)||void 0===t?void 0:t.client},errorImg:function(){return o["__imgPath"]+"image/fb_map_thumbnail/undefined.png"},hasPermission:function(){return l["a"].hasPermission("push_banner")},pushDate:function(t){var e,n=t.item,a=null===n||void 0===n||null===(e=n.log)||void 0===e?void 0:e.push_at;return Object(u["b"])(new Date(a))},showPushDate:function(){var t;return Boolean(null===(t=this.item)||void 0===t?void 0:t.log)}},watch:{},methods:{getBanner:function(t){if(t.post_banner)return Object(s["s"])(t.post_banner);var e,n,a,i,r,c=(null===(e=t.post_meta)||void 0===e?void 0:e.fb_zlp)||t.zlp||this.$store.state.default_zlp,u=t.post_subtype||this.$store.state.default_fb,l=null===(n=this.$store.state.map)||void 0===n||null===(a=n[c])||void 0===a||null===(i=a.dungeon)||void 0===i||null===(r=i[u])||void 0===r?void 0:r.icon;return l?o["__imgPath"]+l:o["__imgPath"]+"image/fb_map_thumbnail/null.png"},format:function(t,e){var n,a=null===t||void 0===t||null===(n=t.post_meta)||void 0===n?void 0:n[e];return a&&a.length?a:["-"]},addTopic:function(t){this.$router.push({query:{topic:t}})},reporterLink:function(t){var e="std"===this.client?"www":"origin";return"".concat(e,":/").concat(r["a"],"/")+t},showDate:u["b"],isRecent:function(){var t,e,n=null===(t=this.item)||void 0===t||null===(e=t.log)||void 0===e?void 0:e.push_at;return p()().diff(p()(n),"day")<30},onPush:function(){h["a"].emit("design-task",this.item)}},filters:{authorLink:s["a"],postLink:function(t){return location.origin+"/".concat(r["a"],"/")+t},showHighlight:function(t){return t?"color:".concat(t,";font-weight:600;"):""},showMark:function(t){return c["a"][t]||t},showAvatar:function(t){return Object(s["r"])(null===t||void 0===t?void 0:t.user_avatar)},showNickname:function(t){return(null===t||void 0===t?void 0:t.display_name)||"匿名"},dateFormat:function(t){return Object(u["b"])(new Date(t))}},created:function(){},mounted:function(){}},m=f,v=n("2877"),g=Object(v["a"])(m,a,i,!1,null,null,null);e["a"]=g.exports},"498a":function(t,e,n){"use strict";var a=n("23e7"),i=n("58a8").trim,r=n("c8d2");a({target:"String",proto:!0,forced:r("trim")},{trim:function(){return i(this)}})},"6afb":function(t,e,n){},a475:function(t,e,n){"use strict";n("6afb")},afb3:function(t,e,n){},c8d2:function(t,e,n){"use strict";var a=n("5e77").PROPER,i=n("d039"),r=n("5899"),s="​᠎";t.exports=function(t){return i((function(){return!!r[t]()||s[t]()!==s||a&&r[t].name!==t}))}},d504:function(t,e,n){"use strict";n.r(e);n("ac1f"),n("841c"),n("498a");var a=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-archive-box"},[e("div",{staticClass:"m-archive-search",attrs:{slot:"search-before"},slot:"search-before"},[e("a",{staticClass:"u-publish el-button el-button--primary",attrs:{href:t.publish_link}},[t._v("+ 发布作品")]),e("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:t.onSearch},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},scopedSlots:t._u([{key:"append",fn:function(){return[e("el-button",{attrs:{icon:"el-icon-position"},on:{click:t.onSearch}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[e("i",{staticClass:"el-icon-search"}),t._v(" 关键词")])])],1),e("div",{staticClass:"m-archive-filter"},[e("clientBy",{attrs:{type:t.client},on:{filter:t.filterImperceptibly}}),e("markBy",{on:{filter:t.filterMeta}}),e("orderBy",{on:{filter:t.filterMeta}})],1),t.data&&t.data.length?e("div",{staticClass:"m-archive-list"},[e("ul",{staticClass:"u-list"},t._l(t.data,(function(n,a){return e("list-item",{key:a+n,attrs:{item:n,order:t.order,caller:"fb_index_click"}})})),1)]):e("el-alert",{staticClass:"m-archive-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasNextPage,expression:"hasNextPage"}],staticClass:"m-archive-more",attrs:{type:"primary",loading:t.loading,icon:"el-icon-arrow-down"},on:{click:t.appendPage}},[t._v("加载更多")]),e("el-pagination",{staticClass:"m-archive-pages",attrs:{background:"",layout:"total, prev, pager, next, jumper","hide-on-single-page":!0,"page-size":t.per,total:t.total,"current-page":t.page},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.changePage}}),e("design-task",{attrs:{post:t.currentPost},model:{value:t.showDesignTask,callback:function(e){t.showDesignTask=e},expression:"showDesignTask"}})],1)},i=[],r=n("ade3"),s=n("c7eb"),o=n("1da1"),c=(n("99af"),n("7db0"),n("caad"),n("a15b"),n("d81d"),n("14d9"),n("b0c0"),n("b64b"),n("d3b7"),n("2c3e"),n("2532"),n("0643"),n("fffc"),n("a573"),n("1fb9")),u=n("44fd"),l=n("85e4"),d=n("29c2"),p=n("16e5"),h=n("41cb"),f=function(t){return Object(h["a"])().get("/api/cms/design/task/log",{params:t})},m=n("7d14"),v=n("d8ad"),g=n("c9d2"),_=(n("4de4"),n("2382"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-filter-client"},[e("ul",[e("li",{staticClass:"u-client",class:{on:""==t.version},on:{click:function(e){return t.filter("")}}},[t._v(" 双端 ")]),t._l(t.versions,(function(n,a){return e("li",{key:a,staticClass:"u-client",class:{on:t.version==a},on:{click:function(e){return t.filter(a)}}},[t._v(t._s(n))])}))],2)])}),b=[],k={name:"versionBy",props:["value"],data:function(){return{version:this.value||""}},computed:{versions:function(){var t={0:"旗舰",1:"无界"};return t}},methods:{filter:function(t){this.version=t,this.$emit("filter",{type:"version",val:t}),this.$forceUpdate()}}},y=k,w=(n("a475"),n("2877")),C=Object(w["a"])(y,_,b,!1,null,null,null),D=(C.exports,{name:"Index",props:[],data:function(){return{loading:!1,data:[],page:1,per:10,total:1,pages:1,number_queries:["per","page"],subtype:"",order:"update",mark:"",client:this.$store.state.client,search:"",topic:"",showDesignTask:!1,currentPost:{}}},computed:{publish_link:function(){return Object(l["p"])(c["a"])},hasNextPage:function(){return this.pages>1&&this.page<this.total},query:function(){return{subtype:this.subtype,order:this.order,mark:this.mark,client:this.client,topic:this.topic}},pg_queries:function(){return{page:this.page,per:this.per}},reset_queries:function(){return[this.subtype]},aggregate:function(){var t=this;return this.data.map((function(e){return t.postLink(e.ID)}))}},methods:{postLink:function(t){return"/".concat(c["a"],"/")+t},reporterLink:function(t){var e="std"===this.client?"www":"origin";return"".concat(e,":/").concat(c["a"],"/")+t},onSearch:function(){this.page=1,this.loadData()},buildQuery:function(t){t&&(this.page+=1,this.replaceRoute({page:this.page},!1));var e={per:this.per,page:this.page};for(var n in this.query)void 0!==this.query[n]&&""!==this.query[n]&&null!==this.query[n]&&("search"==n?e.search=this.query.search.trim():e[n]=this.query[n]);return e.subtype&&(e.sticky=1),this.search&&(e.search=this.search.trim()),e},loadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.buildQuery(e);return console.log("[cms-list]","<loading data>",n),this.loading=!0,Object(d["b"])(n).then(function(){var n=Object(o["a"])(Object(s["a"])().mark((function n(a){var i,r,o,c,u,l,d,h,m,v,_,b;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.data=e?t.data.concat(null===(d=a.data)||void 0===d||null===(h=d.data)||void 0===h?void 0:h.list):null===(m=a.data)||void 0===m||null===(v=m.data)||void 0===v?void 0:v.list,t.total=null===(i=a.data)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.total,t.pages=null===(o=a.data)||void 0===o||null===(c=o.data)||void 0===c?void 0:c.pages,Object(p["b"])({caller:"fb_index_load",data:{aggregate:null===(u=a.data)||void 0===u||null===(l=u.data)||void 0===l?void 0:l.list.map((function(e){return t.reporterLink(e.ID)}))}}),!g["a"].hasPermission("push_banner")||t.isPhone){n.next=10;break}return _=t.data.map((function(t){return t.ID})),n.next=8,f({source_type:"fb",ids:_.join(",")}).then((function(t){return t.data.data}));case 8:b=n.sent,t.data=t.data.map((function(e){var n=b.find((function(t){return t.source_id==e.ID}))||null;return t.$set(e,"log",n),e}));case 10:t.$forceUpdate();case 11:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).finally((function(){t.loading=!1}))},replaceRoute:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.$router.push({name:this.$route.name,query:Object.assign({},this.$route.query,t)}).then((function(){e&&window.scrollTo(0,0)})).catch((function(t){}))},filterMeta:function(t){this.replaceRoute(Object(r["a"])(Object(r["a"])({},t["type"],t["val"]),"page",1))},filterImperceptibly:function(t){this[t["type"]]=t["val"]},changePage:function(t){this.loadData(),this.replaceRoute({page:t})},appendPage:function(){this.loadData(!0)}},watch:{"$route.query":{deep:!0,immediate:!0,handler:function(t){if(Object.keys(t).length)for(var e in console.log("[cms-list]","<route query change>",t),t)this.number_queries.includes(e)?this[e]=~~t[e]:this[e]=t[e],"fb_name"==e&&(this.subtype=t.fb_name)}},reset_queries:{deep:!0,handler:function(){console.log("[cms-list]","<reset page>"),this.page=1}},query:{deep:!0,immediate:!0,handler:function(t){console.log("[cms-list]","<request query change>",t),this.loadData()}}},mounted:function(){var t=this;v["a"].on("design-task",(function(e){t.currentPost=e,t.showDesignTask=!0}))},components:{listItem:u["a"],DesignTask:m["a"]}}),x=D,j=(n("1ee7"),Object(w["a"])(x,a,i,!1,null,null,null));e["default"]=j.exports},d8ad:function(t,e,n){"use strict";var a=n("1344"),i=Object(a["a"])();e["a"]=i}}]);
//# sourceMappingURL=chunk-1dfecdd1.c22941c0.js.map